<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <title>é–²è¦§è€…ç”¨ãƒšãƒ¼ã‚¸ï¼ˆWebã‚«ãƒ¡ãƒ©ç‰ˆï¼‰</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: black;
    }

    /* ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’ç”»é¢ã„ã£ã±ã„ã«è¡¨ç¤º */
    #camera {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    /* â—‹Ã—è¡¨ç¤ºç”¨ */
    #status {
      position: fixed;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 8em;
      color: white;
      text-shadow: 0 0 20px black;
      z-index: 1;
      pointer-events: none;
    }

    /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º */
    #loading {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 2em;
      z-index: 2;
    }
  </style>
</head>

<body>

  <div id="loading">ã‚«ãƒ¡ãƒ©èµ·å‹•ä¸­â€¦</div>
  <video id="camera" autoplay playsinline muted></video>
  <div id="status">ğŸ”„</div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

  <script>
    // ğŸ”§ ã‚«ãƒ¡ãƒ©èµ·å‹•
    const video = document.getElementById("camera");
    const loading = document.getElementById("loading");
    navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
      .then(stream => {
        video.srcObject = stream;
        loading.style.display = "none"; // ã‚«ãƒ¡ãƒ©èµ·å‹•å®Œäº†ã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
      })
      .catch(err => {
        loading.textContent = "ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•ã§ãã¾ã›ã‚“: " + err;
      });

    // ğŸ”§ FirebaseåˆæœŸåŒ–
    const firebaseConfig = {
      apiKey: "AIzaSyBCBmEzgp94ik4BdrSW0gxN-JwtBHwdvVw",
      authDomain: "kadaikenkyu-f09eb.firebaseapp.com",
      databaseURL: "https://kadaikenkyu-f09eb-default-rtdb.firebaseio.com",
      projectId: "kadaikenkyu-f09eb",
      storageBucket: "kadaikenkyu-f09eb.appspot.com",
      messagingSenderId: "630288283837",
      appId: "1:630288283837:web:bd2572959010b0e7c5dfd4"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const statusEl = document.getElementById("status");

    // ğŸ”§ Firestoreç›£è¦–ï¼ˆcontrol.htmlã§æ›¸ãè¾¼ã‚€ status/value ã‚’å‚ç…§ï¼‰
    db.ref("status/value").on("value", snapshot => {
      const val = snapshot.val();
      if (val === "ok") {
        statusEl.textContent = "ğŸŸ¢ OK";
      } else if (val === "ng") {
        statusEl.textContent = "ğŸ”´ NG";
      } else {
        statusEl.textContent = "ğŸ”„"; // åˆæœŸçŠ¶æ…‹
      }
    });
  </script>

</body>

</html>